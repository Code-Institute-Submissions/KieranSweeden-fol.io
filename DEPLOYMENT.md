# <img src="readme/images/general/fol.io-short-logo-readme-header.png" height="25"> fol.io Deployment

Within this markdown file, you'll find various deployment procedures that need to be undertaken in order to obtain your own version of fol.io.

<a href="https://folio-web-app.herokuapp.com/" target="_blank">Link to live deployment of fol.io</a>

To navigate back to the README file, [click here](README.md).

## Prerequisites

The following is a list of prerequisites that are required in order to deploy fol.io.

- Python 3 installed (Along with pip to install packages listed within the requirements.txt file).
- Git installed to proceed with git commands that make deployment possible.
- An IDE of your choice to access the fol.io codebase.
- A Stripe account to enable card payment functionality.
- An AWS account with access to S3 (Along with a created S3 bucket to contain static files).

## Clone fol.io Locally

The following are procedures that need to be undertaken in order to run a local version of fol.io.

1. Create an account / sign in with [GitHub](https://github.com/).
2. Re-direct to the main page of the [fol.io respository](https://github.com/KieranSweeden/fol.io).
3. Click the "Code" dropdown button located above the amount of commits made to the GitHub repository.
4. Copy the URL link provided within the dropdown that appears after clicking the "Code" button.
5. Using the terminal found within your chosen IDE, move your current working directory to a place where you'd like to store your local version of fol.io.
6. Enter the following git command within the terminal of your IDE to clone the fol.io codebase:
    ```bash
    git clone https://github.com/KieranSweeden/fol.io.git
    ```
    You should now see the contents of your current working directory filled within the fol.io codebase.
7. Store the following environment variables in a way that you prefer, an example of which could be storing them within a file that's gitignored and will therefore not be pushed to a remote repository online. Although the original version used environment variables via Gitpod, the following will assume your proceeding with popular env.py method.
    ```python
    import os

    #Django environment variables
    os.environ.setdefault('DEVELOPMENT', True)
    os.environ.setdefault('SECRET_KEY', <SECRET_KEY>)

    #Stripe environment variables
    os.environ.setdefault('STRIPE_PUBLIC_KEY', <STRIPE_PUBLIC_KEY>)
    os.environ.setdefault('STRIPE_SECRET_KEY', <STRIPE_SECRET_KEY>)
    os.environ.setdefault('STRIPE_ENDPOINT_SECRET', <STRIPE_ENDPOINT_SECRET>)
    os.environ.setdefault('FOLIO_LICENSE_PRICE_ID', <FOLIO_LICENSE_PRICE_ID>)
    ```
    <details>

    <summary>Environment Variables Explainers</summary>

    - DEVELOPMENT
        - This is used to run particular code when the codebase is within it's development environment.
    - SECRET_KEY
        - This can be any secret key of your choice. A recommended secret key generator could be any of the longer keys found within [RandomKeyGen](https://randomkeygen.com/).
    - STRIPE_PUBLIC_KEY
        - This is a public key generated by Stripe. This can be found under the alias of "Publishable Key" within the Stripe dashboard under the API keys tab.
    - STRIPE_PRIVATE_KEY
        - This is a private "Test Secret Key" that's generated by Stripe and can also be found within the API keys tab within the Stripe dashboard.
    - STRIPE_ENDPOINT_SECRET
        - This is a unique secret key generated by Stripe for the webhook that handles payments with the fol.io application. To find this, ensure you've created a webhook url that matches the webhook url found within the fol.io application (<site_url>/license/checkout/webhook/). You can then find the endpoint secret under the alias of "Signing secret" within the page dedicated to the webhook on the Stripe dashboard.
    - FOLIO_LICENSE_PRICE_ID
        - This is a unique Stripe API ID that's used to verify the product being purchased, in this case it's fol.io licenses. This can be obtained by creating a fol.io license product within the Products section of the Stripe dashboard.

    </details>

8. With your environment variables saved and working as expected, you can now install all of the required packages listed within the requirements.txt by entering the following command:
    ```bash
    pip3 install requirements.txt
    ```

9. With the dependency packages all installed, you should now process the necessary database migrations by entering the following commands:
    ```bash
    python manage.py makemigrations
    ```

    ```bash
    python manage.py migrate
    ```

10. The application is now all set! However, you don't have a way to login as an administrator. To create a new admin account, enter the following command and follow the steps it provides to create a new superuser:
    ```bash
    python manage.py createsuperuser
    ```

11. You're all set. All that's left to do is to launch the server, which can be done by simply entering the following command:
    ```bash
    python manage.py runserver
    ```

12. With the application now live on your local environment, you can now add "/admin" to the end of the url and sign in using the superuser account you recently created.

## Deploy fol.io live with Heroku

## Create an AWS S3 Bucket

## Provide fol.io access to S3 Bucket via AWS IAM





